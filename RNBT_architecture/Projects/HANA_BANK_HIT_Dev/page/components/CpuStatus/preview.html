<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CpuStatus - Preview</title>
    <link rel="stylesheet" href="styles/component.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body>
    <div id="cpu-status-container">
        <div class="cpu-status">
            <!-- Header -->
            <div class="group">
                <div class="header">
                    <div class="title">
                        <div class="icon">
                            <img src="assets/6e134c6c4f175a81f94018216584fd808a1b84b6.svg" alt="">
                        </div>
                        <p class="title-text">주요 업무 그룹 CPU 현황</p>
                    </div>
                </div>
            </div>

            <!-- Container -->
            <div class="container">
                <div class="contents">
                    <!-- Charts rendered by JavaScript -->
                </div>
            </div>

            <!-- Inset shadow overlay -->
            <div class="inset-shadow"></div>
        </div>
    </div>

    <script>
        // Mock data for preview
        const mockData = {
            items: [
                { name: '상품', value: 24, color: '#E3B500', labelColor: 'cyan' },
                { name: '디지털업무', value: 20, color: '#00A9AE', labelColor: 'yellow' },
                { name: 'EBK', value: 18, color: '#00A9AE', labelColor: 'cyan' },
                { name: '채널EIC', value: 2, color: '#DF7200', labelColor: 'orange' },
                { name: '대내EIC', value: 5, color: '#00A9AE', labelColor: 'cyan' },
                { name: '대외EIC', value: 8, color: '#BE1813', labelColor: 'red' }
            ]
        };

        // Chart configuration
        const chartConfig = {
            trackColor: '#22302B',
            radius: ['75%', '90%'],
            labelFontSize: 14,
            labelFontWeight: 700
        };

        // Create pie chart option
        function createPieOption(item, config) {
            return {
                series: [{
                    type: 'pie',
                    radius: config.radius,
                    center: ['50%', '50%'],
                    startAngle: 90,
                    silent: true,
                    data: [
                        {
                            value: item.value,
                            itemStyle: { color: item.color }
                        },
                        {
                            value: 100 - item.value,
                            itemStyle: { color: config.trackColor }
                        }
                    ],
                    label: { show: false },
                    labelLine: { show: false }
                }],
                graphic: {
                    type: 'text',
                    left: 'center',
                    top: 'center',
                    style: {
                        text: `${item.value}%`,
                        fill: '#ffffff',
                        fontSize: config.labelFontSize,
                        fontWeight: config.labelFontWeight,
                        fontFamily: 'Pretendard',
                        textAlign: 'center',
                        textVerticalAlign: 'middle'
                    }
                }
            };
        }

        // Render charts
        function renderCharts(data) {
            const contentsEl = document.querySelector('.contents');
            if (!contentsEl) return;

            data.items.forEach((item, index) => {
                // Create chart item structure
                const chartItem = document.createElement('div');
                chartItem.className = 'chart-item';
                chartItem.dataset.index = index;
                chartItem.dataset.name = item.name;

                // Chart container
                const chartContainer = document.createElement('div');
                chartContainer.className = 'chart-container';
                chartContainer.id = `cpu-chart-${index}`;

                // Label
                const label = document.createElement('div');
                label.className = `item-label item-label-${item.labelColor}`;
                label.innerHTML = `<p>${item.name}</p>`;

                chartItem.appendChild(chartContainer);
                chartItem.appendChild(label);
                contentsEl.appendChild(chartItem);

                // Initialize ECharts
                const chart = echarts.init(chartContainer);
                chart.setOption(createPieOption(item, chartConfig));
            });
        }

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', () => {
            renderCharts(mockData);
        });
    </script>
</body>
</html>
